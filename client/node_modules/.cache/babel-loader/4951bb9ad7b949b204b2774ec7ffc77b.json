{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/aditi/rocks-and-logs/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/aditi/rocks-and-logs/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{ADMIN_LOADED,AUTH_ERROR,LOGIN_FAIL,LOGIN_SUCCESS,LOGOUT}from'./types';import setAuthToken from'../utils/setAuthToken';//import api from '../utils/api'\n//load admin\nexport var loadAdmin=function loadAdmin(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);//console.log(\"token: \", localStorage.token);\n}_context.prev=1;_context.next=4;return axios.get(\"/auth/\");case 4:res=_context.sent;dispatch({type:ADMIN_LOADED,payload:res.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:AUTH_ERROR});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};//login admin\nexport var login=function login(Name,Password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var body,res,errors,errMsg;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// const config = {\n//     headers: {\n//         'Content-Type': 'application/json'\n//     }\n// };\nbody={Name:Name,Password:Password};//console.log(\"auth/actions body : \", body);\n_context2.prev=1;_context2.next=4;return axios.post(\"/auth/adminLogin\",body);case 4:res=_context2.sent;//console.log(\"auth/actions: \", res.data);\ndispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(loadAdmin());_context2.next=15;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);errors=_context2.t0.response.data.errors;errMsg='';errors===null||errors===void 0?void 0:errors.forEach(function(error){return errMsg=error.msg;});dispatch({type:LOGIN_FAIL,errMsg:errMsg});case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};//logout\nexport var logout=function logout(){return function(dispatch){dispatch({type:LOGOUT});};};","map":{"version":3,"sources":["C:/Users/aditi/rocks-and-logs/client/src/actions/auth.js"],"names":["axios","ADMIN_LOADED","AUTH_ERROR","LOGIN_FAIL","LOGIN_SUCCESS","LOGOUT","setAuthToken","loadAdmin","dispatch","localStorage","token","get","res","type","payload","data","login","Name","Password","body","post","errors","response","errMsg","forEach","error","msg","logout"],"mappings":"mTAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,YAAT,CAAuBC,UAAvB,CAAmCC,UAAnC,CAA+CC,aAA/C,CAA8DC,MAA9D,KAA4E,SAA5E,CACA,MAAOC,CAAAA,YAAP,KAAyB,uBAAzB,CACA;AAEA;AACA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,kGAAM,iBAAMC,QAAN,0HAC3B,GAAGC,YAAY,CAACC,KAAhB,CAAuB,CACnBJ,YAAY,CAACG,YAAY,CAACC,KAAd,CAAZ,CACA;AACH,CAJ0B,sCAOLV,CAAAA,KAAK,CAACW,GAAN,CAAU,QAAV,CAPK,QAOjBC,GAPiB,eAQvBJ,QAAQ,CAAC,CACLK,IAAI,CAAEZ,YADD,CAELa,OAAO,CAAEF,GAAG,CAACG,IAFR,CAAD,CAAR,CARuB,+EAavBP,QAAQ,CAAC,CACLK,IAAI,CAAEX,UADD,CAAD,CAAR,CAbuB,oEAAN,gEAAlB,CAmBP;AACA,MAAO,IAAMc,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,IAAD,CAAOC,QAAP,kGAAoB,kBAAMV,QAAN,iJACrC;AACA;AACA;AACA;AACA;AAGMW,IAR+B,CAQxB,CAACF,IAAI,CAAJA,IAAD,CAAOC,QAAQ,CAARA,QAAP,CARwB,CASrC;AATqC,wCAYflB,CAAAA,KAAK,CAACoB,IAAN,CAAW,kBAAX,CAA+BD,IAA/B,CAZe,QAY3BP,GAZ2B,gBAajC;AACAJ,QAAQ,CAAC,CACLK,IAAI,CAAET,aADD,CAELU,OAAO,CAAEF,GAAG,CAACG,IAFR,CAAD,CAAR,CAKAP,QAAQ,CAACD,SAAS,EAAV,CAAR,CAnBiC,mFAsB3Bc,MAtB2B,CAsBlB,aAAIC,QAAJ,CAAaP,IAAb,CAAkBM,MAtBA,CAuB7BE,MAvB6B,CAuBpB,EAvBoB,CAwBjCF,MAAM,OAAN,EAAAA,MAAM,SAAN,QAAAA,MAAM,CAAEG,OAAR,CAAgB,SAAAC,KAAK,QAAIF,CAAAA,MAAM,CAAIE,KAAK,CAACC,GAApB,EAArB,EACAlB,QAAQ,CAAC,CACLK,IAAI,CAAEV,UADD,CAELoB,MAAM,CAAEA,MAFH,CAAD,CAAR,CAzBiC,sEAApB,kEAAd,CAmCP;AACA,MAAO,IAAMI,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,SAAM,UAAAnB,QAAQ,CAAI,CACpCA,QAAQ,CAAC,CAAEK,IAAI,CAAER,MAAR,CAAD,CAAR,CACH,CAFqB,EAAf","sourcesContent":["import axios from 'axios';\r\nimport { ADMIN_LOADED, AUTH_ERROR, LOGIN_FAIL, LOGIN_SUCCESS, LOGOUT } from './types';\r\nimport setAuthToken from '../utils/setAuthToken';\r\n//import api from '../utils/api'\r\n\r\n//load admin\r\nexport const loadAdmin = () => async dispatch => {\r\n    if(localStorage.token) {\r\n        setAuthToken(localStorage.token);\r\n        //console.log(\"token: \", localStorage.token);\r\n    }\r\n\r\n    try {\r\n        const res = await axios.get(\"/auth/\");\r\n        dispatch({\r\n            type: ADMIN_LOADED,\r\n            payload: res.data\r\n        })\r\n    } catch(err) {\r\n        dispatch({\r\n            type: AUTH_ERROR\r\n        })\r\n    }\r\n} \r\n\r\n//login admin\r\nexport const login = (Name, Password) => async dispatch => {\r\n    // const config = {\r\n    //     headers: {\r\n    //         'Content-Type': 'application/json'\r\n    //     }\r\n    // };\r\n  \r\n\r\n    const body = {Name, Password};\r\n    //console.log(\"auth/actions body : \", body);\r\n\r\n    try {\r\n        const res = await axios.post(\"/auth/adminLogin\", body);\r\n        //console.log(\"auth/actions: \", res.data);\r\n        dispatch({\r\n            type: LOGIN_SUCCESS,\r\n            payload: res.data\r\n        });\r\n        \r\n        dispatch(loadAdmin());\r\n        \r\n    } catch(err) {\r\n        const errors = err.response.data.errors;\r\n        let errMsg = '';\r\n        errors?.forEach(error => errMsg = (error.msg));\r\n        dispatch({\r\n            type: LOGIN_FAIL,\r\n            errMsg: errMsg\r\n        });\r\n    }\r\n\r\n\r\n}\r\n\r\n\r\n//logout\r\nexport const logout = () => dispatch => {\r\n    dispatch({ type: LOGOUT });\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}